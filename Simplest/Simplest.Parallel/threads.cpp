/* MultiCore malware project
 * Simplest code-split strategy example
 * Marcus Botacin - 2017
 * Federal University of Paraná (UFPR)
 */

/* Include block */
#include "threads.h"
#include "functions.h"
#include <Windows.h>
#include <stdio.h>

/* Thread 1 */
DWORD WINAPI T1( LPVOID lpParam )
{
	/* exibits only the filesystem changer behavior */
	file();
	return 0;
}

/* Thread 2 */
DWORD WINAPI T2( LPVOID lpParam )
{
	/* exibits only the process creation behavior */
	proc();
	return 0;
}

/* Thread 3 */
DWORD WINAPI T3( LPVOID lpParam )
{
	/* exibits only the registry changer behavior */
	/* debug print */
	printf("PID %x TID %x\n",GetCurrentProcessId(),GetCurrentThreadId());
	reg();
	return 0;
}