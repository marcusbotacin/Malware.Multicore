/* Multicore Malware Project
* Get number of cores of current machine
* Marcus Botacin - 2017
* Federal University of Paraná (UFPR)
*/

/* Include Block */
#include<stdio.h>
#include<Windows.h>

/* how many cores to consider as a real machine */
#define MINIMUM_CORES 2

int main()
{
	/* Get the number of cores */
	int cores = GetMaximumProcessorCount(0);
	/* Display information */
	printf("Cores: %d\n",cores);
	/* check if real machine or VM */
	if (cores>=MINIMUM_CORES)
	{
		printf("Real\n");
	}else{
		printf("VM\n");
	}
	return 0;
}