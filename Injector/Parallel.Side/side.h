/* Multi-Core malware project
 * Distributed DLL Injector Example
 * Marcus Botacin - 2017
 * Federal University of Paraná (UFPR)
 */

/* OS imports */
#include<Windows.h>
#include<intrin.h>

/* Size of L1 cache of my processor - adjust for your one */
#define L1_CACHE_SIZE 128*1024 // 128KB

/* How much is slow enough ? Each processor/OS/so on requires a distinct number */
#define SLOW_ENOUGH 10000

/* Functions */

/* Release lock */
VOID release();
/* Count the number of spent ticks */
UINT64 get_ticks();
/* Check cache access time */
BOOL test_cache(int *addr);