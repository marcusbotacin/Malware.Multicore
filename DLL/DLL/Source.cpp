/* MultiCore malware project
 * Simple DLL to be injected into other processes
 * Marcus Botacin - 2017
 * Federal University of Paraná (UFPR)
*/

/* Include Block */
#include<Windows.h>

/* C prototype on C++ project */
extern "C"
{
	/* Malicious Function */
	/* Just a proof of concept */
    __declspec(dllexport) void malicious()
    {
        OutputDebugStringA("Malicious\n");
    }
}

/* Entry Point */
BOOL APIENTRY DllMain(
   HANDLE hModule,
   DWORD ul_reason_for_call, 
   LPVOID lpReserved )
{
	/* Calling reason */
   switch ( ul_reason_for_call )
   {
	   /* Attached to a process */
      case DLL_PROCESS_ATTACH:
		  OutputDebugStringA("DLL Loaded\n");
      break;
  
	  /* Attached to a thread */
      case DLL_THREAD_ATTACH:
	  /* Nothing to do */
      break;
      
	  /* Detached from a thread */
      case DLL_THREAD_DETACH:
      /* Nothing to do */
      break;
      
	  /* Detached  from a process */
      case DLL_PROCESS_DETACH:
		  OutputDebugStringA("DLL Unloaded\n");
      break;
   }
   return TRUE;
}